package com.valtech.poc.sms.dao;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Component;

import com.valtech.poc.sms.entities.User;
import com.valtech.poc.sms.service.UserRowMapper;

@Component
public class ManagerDAOImpl implements ManagerDAO {

	@Autowired
	private JdbcTemplate jdbcTemplate;
	
	@Override
	public User getManagerByEmpId(int empId) {
		// TODO Auto-generated method stub
//		String sql="select * from user u where u.emp_id=? AND u.u_id=(select ur.u_id from roles r INNER JOIN user_roles ur ON r.r_id = ur.r_id AND r.role in ('Manager'));";
//		User user = jdbcTemplate.queryForObject(sql, new Object[]{empId}, new UserRowMapper());
//
//		return user;
//		String sql = "SELECT * FROM users WHERE id = ?";
		User user = jdbcTemplate.queryForObject(sql, new Object[]{empId}, new RowMapper<User>() {
		    public User mapRow(ResultSet rs, int rowNum) throws SQLException {
		        User user = new User();
		        user.setId(rs.getInt("id"));
		        user.setName(rs.getString("name"));
		        user.setEmail(rs.getString("email"));
		        return user;
		    }
		});
	}

}
